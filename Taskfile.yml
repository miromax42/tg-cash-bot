version: '3'

env:
  ENV: test

dotenv: ['.env', '{{.ENV}}.env']

tasks:
  test:
    cmds:
      - go test --coverprofile=coverage.out ./...
      - go tool cover -func=coverage.out | grep 'total:' | grep -o -E "[0-9\.]+%" | awk '{$2="total";print}'
  run: go run ./...
  gen: go generate ./...
  lint: golangci-lint run ./...